<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta property="og:image" content="../images/image-facebook.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1080">
        <meta property="og:image:height" content="1080">

        
        
        <link rel="canonical" href="https://sumo.dlr.de/docs/Simulation/Taxi.html">
        <link rel="shortcut icon" href="../favicon.ico">
        
        <title>Simulation/Taxi - SUMO Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 

      <script>
        // DARK MODE
        function detectColorScheme(){
          var theme="light";

          if(localStorage.getItem("sumo-docs-theme")){
              if(localStorage.getItem("sumo-docs-theme") == "dark"){
                  var theme = "dark";
              }
          } else if(!window.matchMedia) {
              return false;
          } else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
              var theme = "dark";
          }

          if (theme=="dark") {
              document.documentElement.setAttribute("data-theme", "dark");
          }
        }
        detectColorScheme();
      </script>

    </head>

    <body>

        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary text-center">
            <div class="container-fluid">
                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../index.html" class="nav-link">Documentation</a>
                            </li>
                            <li class="navitem">
                                <a href="../Tutorials.html" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../FAQ.html" class="nav-link">FAQ</a>
                            </li>
                            <li class="navitem">
                                <a href="../Downloads.html" class="nav-link">Downloads</a>
                            </li>
                            <li class="navitem">
                                <a href="../Publications.html" class="nav-link">Publications</a>
                            </li>
                            <li class="navitem">
                                <a href="../Developer/Main.html" class="nav-link">Developer</a>
                            </li>
                            <li class="navitem">
                                <a href="../ChangeLog.html" class="nav-link">ChangeLog</a>
                            </li>
                            <li class="navitem">
                                <a href="https://github.com/eclipse/sumo/commits/master/docs/web" class="nav-link">Recent Changes</a>
                            </li>
                            <li class="navitem">
                                <a href="https://eclipse.org/sumo/contact/" class="nav-link">Contact</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> <u>S</u>earch
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="edit" href="https://github.com/eclipse/sumo/edit/master/docs/web/docs/Simulation/Taxi.md" class="nav-link"><i class="fa fa-github"></i> <u>E</u>dit on GitHub</a>
                            </li>
                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                            More <i class="fa fa-chevron-circle-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item no-arrow-link" href="https://github.com/eclipse/sumo/issues">Report a Bug / Issue / Typo</a>
                            <a class="dropdown-item" href="../Editing_Articles.html">Help on editing articles</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#mkdocs_keyboard_modal">Keyboard Shortcuts</a>
                            <a class="dropdown-item no-arrow-link" href="https://sumo.dlr.de/sumo_documentation.zip">Download the Documentation</a>
                            <span class="dropdown-item" id="dark-mode-div">Dark mode <label id="theme-switch" class="theme-switch" for="checkbox_theme">
                              <input type="checkbox" id="checkbox_theme">
                          </label></span>
                          </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container-fluid">
          <div class="row">
                <div class="col-md-3">
                  <div class="text-center"><a href="../index.html" style="display: inline-block; margin-top: 5px;"><img src="../images/sumo-logo.png" class="sumoLogo" alt="SUMO Logo" width="120px"></a></div>
                  
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary toc-scroll toc">
        <ul class="nav flex-column bs-sidenav">
            <p style="margin-top:5px; color:#777777;" class="text-center">Contents</p>
            <li class="nav-item main"><a href="#introduction">Introduction</a></li>
            <li class="nav-item main"><a href="#equipping_vehicles">Equipping vehicles</a></li>
            <li class="nav-item main"><a href="#taxi_requests">Taxi requests</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#direct_ride_hailing" class="nav-link">• Direct ride hailing</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#intermodal_routing" class="nav-link">• Intermodal Routing</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#groups_of_persons" class="nav-link">• Groups of Persons</a>
                </li>
            <li class="nav-item main"><a href="#dispatch">Dispatch</a></li>
            <li class="nav-item main"><a href="#taxi_behavior">Taxi Behavior</a></li>
            <li class="nav-item main"><a href="#traci">TraCI</a></li>
            <li class="nav-item main"><a href="#outputs">Outputs</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#parameter_retrieval" class="nav-link">• Parameter Retrieval</a>
                </li>
        </ul>
    </div>

    <div class="admonition conference" style="position: sticky; margin-top: 20px; margin-bottom:10px;">
        <p>visit <a href="https://eclipse.org/sumo">eclipse.org/sumo</a></p>
        </div>

</div>
                  
                </div>
                <div class="col-md-9 main-area" role="main">
                  
                  <hTitles>Simulation/Taxi<hr style="border: 0.5px solid #338033; margin-top: 5px !important;"></hTitles>
                  
                  

<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">#</a></h1>
<p>Since version 1.5.0 SUMO supports simulation of demand responsive transport (DRT)
via the taxi device. This allows a fleet of taxis to service customer requests
based on a configurable dispatch algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the taxi capabilities are under development, their status can be checked via Issue <a class="gh-link gh-issue" href="https://github.com/eclipse/sumo/issues/6418" title="GitHub Issue eclipse/sumo #6418">#6418</a>.</p>
</div>
<h1 id="equipping_vehicles">Equipping vehicles<a class="headerlink" href="#equipping_vehicles" title="Permanent link">#</a></h1>
<p>A vehicle can be equipped with an Taxi device to make it part of the taxi fleet.
To attach a Taxi device to a vehicle, the <a href="../Definition_of_Vehicles,_Vehicle_Types,_and_Routes.html#devices">standard device-equipment
procedures</a> can be applied using <code>&lt;device name&gt;=taxi</code>.</p>
<p>For instance, a single vehicle can configured as taxi as in the following minimal example</p>
<pre><code>    &lt;vehicle id=&quot;v0&quot; route=&quot;route0&quot; depart=&quot;0&quot; line=&quot;taxi&quot;&gt;
        &lt;param key=&quot;has.taxi.device&quot; value=&quot;true&quot;/&gt;  
    &lt;/vehicle&gt;
</code></pre>

<h1 id="taxi_requests">Taxi requests<a class="headerlink" href="#taxi_requests" title="Permanent link">#</a></h1>
<h2 id="direct_ride_hailing">Direct ride hailing<a class="headerlink" href="#direct_ride_hailing" title="Permanent link">#</a></h2>
<p>A person can be defined as taxi customer with the following definition:</p>
<pre><code>    &lt;person id=&quot;p0&quot; depart=&quot;0.00&quot;&gt;
        &lt;ride from=&quot;B2C2&quot; to=&quot;A0B0&quot; lines=&quot;taxi&quot;/&gt;
    &lt;/person&gt;
</code></pre>

<h2 id="intermodal_routing">Intermodal Routing<a class="headerlink" href="#intermodal_routing" title="Permanent link">#</a></h2>
<p>A person can also use a taxi by including it as a <a href="../Specification/Persons.html#persontrips">personTrip</a> mode:</p>
<pre><code>    &lt;person id=&quot;p0&quot; depart=&quot;0.00&quot;&gt;
        &lt;personTrip from=&quot;B2C2&quot; to=&quot;A0B0&quot; modes=&quot;taxi&quot;/&gt;
    &lt;/person&gt;
</code></pre>

<p>Whenever a person enters a taxi during the intermodal route search, a time penalty is applied to account for the expected time loss from waiting for the taxi and embarking. The default value is set 300s and can be configure with option <strong>--persontrip.taxi.waiting-time</strong>. This prevents rapid switching between travel modes.</p>
<h2 id="groups_of_persons">Groups of Persons<a class="headerlink" href="#groups_of_persons" title="Permanent link">#</a></h2>
<p>Multiple persons can travel together as a group using attribute <code>group</code> (if the taxi has sufficient capacity):</p>
<pre><code>&lt;person id="p0" depart="0.00"&gt;
    &lt;ride from="B2C2" to="A0B0" lines="taxi" group="g0"/&gt;
&lt;/person&gt;
&lt;person id="p1" depart="0.00"&gt;
    &lt;ride from="B2C2" to="A0B0" lines="taxi" group="g0"/&gt;
&lt;/person&gt;
</code></pre>
<h1 id="dispatch">Dispatch<a class="headerlink" href="#dispatch" title="Permanent link">#</a></h1>
<p>The dispatch algorithm assigns taxis to waiting customers. The algorithm is
selected using option <strong>--device.taxi.dispatch-algorithm ALGONAME</strong>. The following
algorithms are available</p>
<ul>
<li>greedy: Assigns taxis to customers in the order of their reservations. The
  closest taxi (in terms of travel time) is assigned. If the reservation date is
  too far in the future, the customer is postponed.</li>
</ul>
<ul>
<li>greedyClosest: For each available taxi, the closest customer (in terms of
  travel time) is assigned. If the reservation date is too far in the future,
  the customer is postponed.</li>
</ul>
<ul>
<li>greedyShared: like 'greedy' but tries to pick up another passenger while delivering the first passenger to it's destination. The algorithm supports parameters <strong>absLossThreshold</strong> and <strong>relLossThreshold</strong> to configure acceptable detours.</li>
</ul>
<ul>
<li>routeExtension: like greedy but can pick up any passenger along the route and also extend the original route (within personCapacity limit).</li>
</ul>
<ul>
<li>traci: Dispatch is defered to <a href="#traci">traci control</a>. The algorithm only keeps track of pending reservations</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>User-contributed dispatch algorithms are welcome.</p>
</div>
<h1 id="taxi_behavior">Taxi Behavior<a class="headerlink" href="#taxi_behavior" title="Permanent link">#</a></h1>
<p>To make a taxi stay in the simulation it receives a stop with attribute <code>triggered="person"</code> after servicing a customer.
It is recommended to also define such a stop in the xml input so that the taxi can wait for the first customer.</p>
<p>By default, taxis will remain in the simulation until all persons have left. To make them leave the simulation at an earlier time, the end time can be defined using a generic parameter in their <code>vType</code> or <code>vehicle</code>-definition:</p>
<pre><code>    &lt;vType id=&quot;taxi&quot; vClass=&quot;taxi&quot;&gt;
        &lt;param key=&quot;has.taxi.device&quot; value=&quot;true&quot;/&gt;
        &lt;param key=&quot;device.taxi.end&quot; value=&quot;3600&quot;/&gt;
    &lt;/vType&gt;
</code></pre>

<h1 id="traci">TraCI<a class="headerlink" href="#traci" title="Permanent link">#</a></h1>
<p>To couple an external dispatch algorithm to SUMO, the following <a href="../TraCI.html">TraCI</a> functions are provided:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To make use of these functions, the option <strong>--device.taxi.dispatch-algorithm traci</strong> must be set</p>
</div>
<ul>
<li>traci.person.getTaxiReservations(onlyNew)</li>
<li>traci.vehicle.getTaxiFleet(taxiState)</li>
<li>traci.vehicle.dispatchTaxi(vehID, reservations)</li>
</ul>
<p>This set of API calls can be used to simplify writing custom dispatch algorithms by letting sumo:</p>
<ul>
<li>manage existing reservations</li>
<li>manage the taxi fleet</li>
<li>dispatch a taxi to service one or more reservations by giving a list of reservation ids (vehicle routing and stopping is then automatic).</li>
</ul>
<h1 id="outputs">Outputs<a class="headerlink" href="#outputs" title="Permanent link">#</a></h1>
<p>The Taxi device generates output within a tripinfo-output file in the following
form:</p>
<pre><code>    &lt;tripinfo id=&quot;trip_0&quot; ... &gt;
        &lt;taxi customers=&quot;5&quot; occupiedDistance=&quot;6748.77&quot; occupiedTime=&quot;595.00&quot;/&gt;
    &lt;/tripinfo&gt;
</code></pre>

<h2 id="parameter_retrieval">Parameter Retrieval<a class="headerlink" href="#parameter_retrieval" title="Permanent link">#</a></h2>
<p>The following parameters can be retrieved via <code>traci.vehicle.getParameter</code> and written via <strong>--fcd-output.params</strong>.
It is also possible to color vehicles in <a href="../sumo-gui.html#vehicle_visualisation_settings">SUMO-GUI 'by param (numerical)'</a> by setting these keys.</p>
<ul>
<li>device.taxi.state:<ul>
<li>0: empty</li>
<li>1: driving to pickup customer</li>
<li>2: occupied</li>
<li>3: pickup + occupied (during ride sharing)</li>
</ul>
</li>
<li>device.taxi.customers: total number of customers served</li>
<li>device.taxi.occupiedDistance: total distance driven in m with customer on board</li>
<li>device.taxi.occupiedTime: total time driven in s with customers on board</li>
</ul>
                </div>
          </div>
          <button onclick="goTopFunction()" id="goToTop" title="Go to top"><i class="fa fa-arrow-up"></i></button>
        </div>

        <footer class="col-md-12">
          
            <br><small><i>This page was last edited on: 01 December 2020</i></small>
          
          <hr>
            <p>Copyright &copy; 2001 - 2020 German Aerospace Center (DLR) and others.</p>
          <p>Follow us on <a class="no-arrow-link" href="https://www.twitter.com/eclipsesumo/"><i class="fa fa-twitter"></i></a> <a class="no-arrow-link" href="https://www.facebook.com/simulationofurbanmobility/"><i class="fa fa-facebook-square"></i></a> <a class="no-arrow-link" href="https://www.instagram.com/eclipse.sumo/"><i class="fa fa-instagram"></i></a>
          | Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a></p>
        </footer>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body" style="color: #495057 !important;">
                <p>Enter your search terms:</p>
                <script async src="https://cse.google.com/cse.js?cx=004302551366764109984:1kpgtzrm6kv"></script>
                <div class="gcse-search"></div>
            </div>
            <div class="modal-footer" style="color: #495057 !important;">
                or search the sumo-user mailing list archive&nbsp;<a class="no-arrow-link" href="http://sumo-user.90755.n8.nabble.com/template/NamlServlet.jtp?macro=search_page&node=1&query=">here</a>
            </div>
        </div>
    </div>
</div>
      <script>
        window.onscroll = function() {scrollFunction()};
        
        function scrollFunction() {
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("goToTop").style.display = "block";
          } else {
            document.getElementById("goToTop").style.display = "none";
          }
        }
    
        function goTopFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        var base_url = "..",
            shortcuts = {"help": 191, "search": 83, "edit": 69};
        </script>
        <script src="../js/base.js" defer></script>

        <script>
          const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');
  
          function switchTheme(e) {
              if (e.target.checked) {
                  localStorage.setItem('sumo-docs-theme', 'dark');
                  document.documentElement.setAttribute('data-theme', 'dark');
                  toggleSwitch.checked = true;
              } else {
                  localStorage.setItem('sumo-docs-theme', 'light');
                  document.documentElement.setAttribute('data-theme', 'light');
                  toggleSwitch.checked = false;
              }    
          }
  
          toggleSwitch.addEventListener('change', switchTheme, false);
  
          if (document.documentElement.getAttribute("data-theme") == "dark"){
              toggleSwitch.checked = true;
          }
          </script>

      <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Key</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody style="color: #495057 !important;">
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help dialog</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search the Documentation</td>
                  </tr>
                  <tr>
                    <td class="edit shortcut"><kbd>e</kbd></td>
                    <td>Edit current page on GitHub</td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>
</div>
    </body>
</html>
